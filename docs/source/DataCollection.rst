======================
Data Collection
======================
Novaland enables the online data collection of participant behavioral data.

Upload your project on Heroku
================================
The goal is to deliver Novaland to participants, in this case via Heroku.

oTree Hub
==================================
There are several ways to upload the project to Heroku.
The easiest way is to use `oTree Hub <https://www.otreehub.com>`_.
oTree Hub is a tool aimed at simplifying the development and deployment process of oTree-based studies.

If you don't have a Heroku account or your account is not connected to oTree Hub.
Then this must be done before you can upload your project to Heroku using oTree Hub.

.. _data-collection-page:

Upload your project on oTree Hub:
________________________________

    1. Open your project in PyCharm.
    2. Go to the Terminal windows and write:

    .. code-block:: console

        otree zip

    3. PyCharm generates an .otreezip file for you, located in the project's root folder.

    4. Open your browser and go to this page:

    .. code-block:: console

        www.otreehub.com

    5. Login or create an account on oTree Hub.

    6. Click on "Heroku" in the menu.
    7. (Only on first deploy:) Link your account on oTree Hub with your account on Heroku.
    8. Select your project and press the 'Deploy' Button.
    9. Upload your .otreezip file on the 'Upload code to Heroku' section.
    10. Follow the link shown on oTree Hub to access your Novaland instance.

Change the configuration of your project on oTree Hub:
________________________________

You need to set up a few more things before the data collection can take place.
In the overview of the project on oTree Hub, select "Configure" in the row with the site you have deployed your Novaland version to.
On the next page:
    - Set Postgres to standard-0
    - Set OTREE_production to On
    - Set OTREE_AUTH_LEVEL to STUDY
    - Set Dyno size to Standard-2X
    - Enable Papertrail and Sentry
You may have to wait a few minutes for your changes to take effect.
You can check whether everything is set up correctly in the admin panel of your Novaland site under "Server Check" every box should now be green.

Before the data collection
=========================

Create a new session
=====================
There are several ways to create a session.
Each can be accessed from the admin panel of your Novaland site.
You will have to log in to the admin panel with the credentials you provided in settings.py.

Via "Demo"
_______________

This session setup is not suitable for conducting a data collection, but is well suited to test your Novaland version.
Click on Demo and select the Session config which contains all the apps of your Novaland version.

Via "Sessions"
______________

This is not ideal to conduct data collections, because the session URL changes each time you create a new session.
Therefore it is not possible to send participants the links well in advance.
However, it is well suited if e.g. you want to test your Novaland version with a larger group.

    1. Click "Sessions" --> Create new session
    2. Select the Session config which contains all the apps of your Novaland version.
    3. Choose a number of participants suitable for your test run. It is often a good idea to choose about 1.5 times the amount of people you expect to take part, because after a session is initialised, you can not raise the number of participants anymore.
    4. Configure your session with the waiting pages and starting / end times you intend to use (see Wait Pages for more info).
    5. Click "Create".

Via "Rooms"
_______________

This is the way to go for data collections, because you can send participants individualised access tokens well in advance of your data collection

    1. Click Rooms anc select the room you want to use.
    2. Select the Session config which contains all the apps of your Novaland version.
    3. Choose a number of participants suitable for your test run. It is often a good idea to choose about 1.5 times the amount of people you expect to take part, because after a session is initialised, you can not raise the number of participants anymore.
    4. Configure your session with the waiting pages and starting / end times you intend to use (see Wait Pages for more info).
    5. Click "Create".


After you have set up your room, you can invite participants e.g.
via E-Mail or any other way of contact with the participant labels shown under "Participant-specific URLs".

During the data collection
=======================
During the session, you can view various features that allow you to observe the activities of participants.

Data
___________________
The 'Data' window, on the other hand, provides insights into the data being generated by your application.
This includes logs, metrics, and events, which can be used to analyze and optimize the performance of your application.
You can also use this data to troubleshoot any issues that may arise.
The 'Player' model's variables are also displayed here.
This is useful for verifying that all variables are being stored correctly.



Close Session
===================
To prevent participants from influencing the study hours after their participation, you can close the session.
Here are the steps to follow:

    1. Click on 'Sessions' in the top bar
    2. Click on the code of the active session that you want to close
    3. You will see a section with the text 'This session is taking place in the room Novaland.' Click on 'Novaland'
    4. You will now see a button labeled 'Close this room' next to the 'Go to active session' section
    5. Press this button to end the session.

Download Data of the participants
=========================================
The participant data and page times can be downloaded in a separate window called 'Data', located at the top of the oTree bar.
This window provides access to CSV files containing all the collected information from all the apps.
You can download data from all apps at once or select specific apps to download data from.

At the bottom of the window, there is also a download button for all page times, which enables you to see how long a participant spent on each page.

To protect your participants data, you should, after you have downloaded all data and created additional backups,
reset your database via:

    1. Go to 'oTree Hub'
    2. Click on 'Heroku' in the menu
    3. Choose your Novaland Site
    4. Go to 'Deploy'
    5. Press 'Reset database'
